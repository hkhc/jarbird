<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/jarbird/blog/rss.xml" title="Jarbird Gradle Plugin Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/jarbird/blog/atom.xml" title="Jarbird Gradle Plugin Blog Atom Feed"><title data-react-helmet="true">Publishing Android Components | Jarbird Gradle Plugin</title><meta data-react-helmet="true" property="og:url" content="https://hkhc.github.io/jarbird/docs/tutorials/android"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Publishing Android Components | Jarbird Gradle Plugin"><meta data-react-helmet="true" name="description" content="In this tutorial, we are going to publish Android AAR library to Maven Central."><meta data-react-helmet="true" property="og:description" content="In this tutorial, we are going to publish Android AAR library to Maven Central."><link data-react-helmet="true" rel="shortcut icon" href="/jarbird/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hkhc.github.io/jarbird/docs/tutorials/android"><link data-react-helmet="true" rel="alternate" href="https://hkhc.github.io/jarbird/docs/tutorials/android" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hkhc.github.io/jarbird/docs/tutorials/android" hreflang="x-default"><link rel="stylesheet" href="/jarbird/assets/css/styles.ed240e73.css">
<link rel="preload" href="/jarbird/assets/js/runtime~main.9cc06e3f.js" as="script">
<link rel="preload" href="/jarbird/assets/js/main.8e29dcb8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/jarbird/"><img src="/jarbird/img/logo.png" alt="Jarbird Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/jarbird/img/logo.png" alt="Jarbird Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Jarbird</strong></a><a class="navbar__item navbar__link" href="/jarbird/docs/intro">Introduction</a><a class="navbar__item navbar__link navbar__link--active" href="/jarbird/docs/tutorials/index">Tutorial</a><a class="navbar__item navbar__link" href="/jarbird/docs/reference/index">Reference</a><a class="navbar__item navbar__link" href="/jarbird/docs/create-account">Create Accounts</a><a class="navbar__item navbar__link" href="/jarbird/docs/build">Build</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hkhc/jarbird" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/jarbird/"><img src="/jarbird/img/logo.png" alt="Jarbird Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/jarbird/img/logo.png" alt="Jarbird Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Jarbird</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/jarbird/docs/tutorials/index">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/reference/index">Reference</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/create-account">Create Accounts</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/build">Build</a></li><li class="menu__list-item"><a href="https://github.com/hkhc/jarbird" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/index">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/simplelib">Simple library</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/samplelibsign">Library with Signature</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/mavencentral">Publish to Maven Central</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/custommaven">Custom Maven repository</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/jarbird/docs/tutorials/android">Android Components</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/artifactory">Custom Artifactory repository</a></li><li class="menu__list-item"><a class="menu__link" href="/jarbird/docs/tutorials/gradleplugin">Gradle Plugin</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Publishing Android Components</h1></header><div class="markdown"><p>In this tutorial, we are going to publish Android AAR library to Maven Central.</p><p>The sample project is [here](<a href="https://github." target="_blank" rel="noopener noreferrer">https://github.</a>
com/hkhc/jarbird-samples/tree/master/android).</p><p>Unlike publishing  conventional JAR libraries, we need to take care of the
<strong>Build Types</strong>, <strong>Flavors</strong>, and <strong>Variants</strong> of Android library projects.</p><p>A variant is a combination of a build type and a flavor, so that it may refer
to a combination of source set, resources, etc. For example, a typical Android project
may have build types <code>debug</code> and <code>release</code>, and flavors for <code>qa</code> and
<code>production</code>. Then we have four different variants:</p><ul><li><code>qaDebug</code></li><li><code>qaRelease</code></li><li><code>productionDebug</code></li><li><code>productionRelease</code></li></ul><p>(We could ignore some combinations that do not make sense for particular
project, please refer to <code>variantFilter</code> in <a href="https://developer.android.com/studio/build/build-variants" target="_blank" rel="noopener noreferrer">Android documentation</a> for details)</p><p>Each of the variants creates a different library and can be published
(or not to be published) individually. Jarbird plugin supports configure
how each of these components is published.</p><p>The source code of this tutorial is in the <code>android</code> directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pomyaml"></a>pom.yaml<a class="hash-link" href="#pomyaml" title="Direct link to heading">#</a></h3><p>The <code>pom.yaml</code> file is not that different from conventional JAR publishing.
The only difference right now is the <code>packaging</code> line.</p><div class="codeBlockContainer_K1bP"><div style="color:rgb(36, 41, 46);background-color:#f6f8fa" class="codeBlockTitle_eoMF">pom.yaml</div><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">group</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> jarbirdsamples</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">artifactId</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> simpleaar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">packaging</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> aar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">licenses</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Apache</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token number">2.0</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">dist</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> repo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">developers</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> demo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Jarbird Demo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">email</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> jarbird.demo@fake</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">email.com</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">scm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">repoType</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> github.com</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">repoName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> demo/jarbird</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">samples/android</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="buildgradle"></a>build.gradle<a class="hash-link" href="#buildgradle" title="Direct link to heading">#</a></h3><p>We have a different plugin ID for Android project:</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">build.gradle</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">build.gradle.kts</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">plugins {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id &#x27;com.android.library&#x27;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id &#x27;kotlin-android&#x27;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id &#x27;io.hkhc.jarbird-android&#x27; version &quot;0.6.0&quot;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><div tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">plugins {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id(&quot;com.android.library&quot;)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id(&quot;kotlin-android&quot;)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">    id(&quot;io.hkhc.jarbird-android&quot;) version &quot;0.6.0&quot;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></div></div><p>There is no new syntax and functions in the plugin <code>io.hkhc.jarbird-android</code>.
It just has additional capability to recognize Android <code>LibraryVariant</code> objects.
It does not hurt to use this plugin on conventional JAR projects. Just looks confusing.</p><p>The build script of typical Android library projects has an android block
to configure the build types and flavors. We add our code after the
<code>android</code> block to specify how they are published, in the Jarbird way.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">build.gradle</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">build.gradle.kts</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// after android {}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach { variant -&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(variant.name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(variant)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><div tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">// after android {}</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(this@configureEach)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></div></div><p>Note how Kotlin and Groovy differ in getting the proper reference to the <code>from()</code>
method. Because of the <code>configureEach</code> loop, we created two <code>pub</code>s, one for
each variant, and the results are two sets of artefacts.</p><p>There are two things in the &quot;jarbird&quot; block that differs from our previous tutorials.
First the additional <code>from()</code> block that we have mentioned. When building
conventional JAR libraries, we normally don&#x27;t need to specify where the source
code comes from. The plugin will figure it out by itself. When publishing Android
AAR components, we need to tell what to publish by passing the <code>LibraryVariant</code>
reference to <code>from()</code> method.</p><p>The other thing to notice is that we provided a name to <code>pub</code>.
It is used to identify them when there are multiple <code>pub</code>.
It could be any string as long as it is unique among <code>pub</code>s. Conventionally we
use the variant name of the Android project.</p><p>Normally Android library has at least two build types, <code>debug</code> and <code>release</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="run-it"></a>Run It<a class="hash-link" href="#run-it" title="Direct link to heading">#</a></h2><p>Executing <code>./gradlew jbPublishToMavenLocal</code> we get two publications:</p><ul><li><code>~/.m2/repository/jarbirdsamples/simpleaar/1.0-release</code></li><li><code>~/.m2/repository/jarbirdsamples/simpleaar/1.0-debug</code></li></ul><p>The artifacts will look like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell-session"><div tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">ls -1 ~/.m2/repository/jarbirdsamples/simpleaar/1.0-release</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release-javadoc.jar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release-javadoc.jar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release-sources.jar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release-sources.jar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.aar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.aar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.module</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.module.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.pom</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-1.0-release.pom.asc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This is the default way to distinguish different publications, that the version
is suffixed by the variant. However, we can change that.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="variant-with-artifactid"></a>Variant with artifactId<a class="hash-link" href="#variant-with-artifactid" title="Direct link to heading">#</a></h2><p>We may make the variant part of the artifactId. We add one line to the Jarbird configuration:</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">build.gradle</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">build.gradle.kts</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach { variant -&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(variant.name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            variantWithArtifactId()</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(variant)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><div tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            variantWithArtifactId()</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(this@configureEach)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></div></div><p>The additional line indicates the artifactId shall be suffixed by the variant.
After executing <code>jbPublishToMavenLocal</code>, we get two publications with
directories like this:</p><ul><li><code>~/.m2/repository/jarbirdsamples/simpleaar-release/1.0</code></li><li><code>~/.m2/repository/jarbirdsamples/simpleaar-debug/1.0</code></li></ul><p>We could have even greater control to the coordinate of components by specifying variant in <code>pom.yaml</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="variant-with-pom"></a>Variant with POM<a class="hash-link" href="#variant-with-pom" title="Direct link to heading">#</a></h2><p>We may customize the POM information for each variant in <code>pom.xml</code>. There
are two ways to do so. In this tutorial, we will focus on the one method first.</p><p>Let&#x27;s change the <code>pom.yaml</code> like this:</p><div class="codeBlockContainer_K1bP"><div style="color:rgb(36, 41, 46);background-color:#f6f8fa" class="codeBlockTitle_eoMF">pom.yaml</div><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">variant</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> debug</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">artifactId</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> simpleaar</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">staging</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">---</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">variant</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> release</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">artifactId</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> simpleaar</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">production</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">---</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">group</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> jarbirdsamples</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">packaging</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> aar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">licenses</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Apache</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token number">2.0</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">dist</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> repo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">developers</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> demo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Jarbird Demo</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">email</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> jarbird.demo@fake</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">email.com</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">scm</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">repoType</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> github.com</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">repoName</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> demo/jarbird</span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain">samples/android</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now our <code>pom.yaml</code> has three sections, two of them have a <code>variant</code> attribute.
When publishing components, Jarbird plugin <strong>combine the section in <code>pom.yaml</code>
with <code>variant</code> attribute and the section without <code>variant</code>.</strong> Therefore
effectively we have different <code>pom.yaml</code> for each of the variants.</p><p>Then we add a line to the <code>build.gradle</code> file.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">build.gradle</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">build.gradle.kts</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly groovy"><div tabindex="0" class="prism-code language-groovy codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach { variant -&gt;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(variant.name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            variantInvisible()</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(variant)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><div tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">android.libraryVariants.configureEach {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    jarbird {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pub(name) {</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            mavenCentral()</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            variantInvisible()</span></div><div class="token-line docusaurus-highlight-code-line" style="color:rgb(36, 41, 46)"><span class="token plain">            from(this@configureEach)</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    }</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></div></div><p>The line <code>variantInvisible()</code> tell Jarbird plugin not to merge the variant name.
So the information of components we built is entirely on <code>pom.yaml</code>.</p><p>Executing <code>./gradlew jbPublishToMavenLocal</code> and we will get the following in
Maven Local repository:</p><ul><li><code>~/.m2/repository/jarbirdsamples/simpleaar-production/1.0</code></li><li><code>~/.m2/repository/jarbirdsamples/simpleaar-staging/1.0</code></li></ul><p>The artifacts of the release variant look like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell-session"><div tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">$ ls -1 ~/.m2/repository/jarbirdsamples/simpleaar-production/1.0</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0-javadoc.jar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0-javadoc.jar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0-sources.jar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0-sources.jar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.aar</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.aar.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.module</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.module.asc</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.pom</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">simpleaar-production-1.0.pom.asc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/hkhc/jarbird-docs/docs/tutorials/android.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/jarbird/docs/tutorials/custommaven"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Publish to custom Maven repositories</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/jarbird/docs/tutorials/artifactory"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Publish to custom Artifactory repositories Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pomyaml" class="table-of-contents__link">pom.yaml</a></li><li><a href="#buildgradle" class="table-of-contents__link">build.gradle</a></li><li><a href="#run-it" class="table-of-contents__link">Run It</a></li><li><a href="#variant-with-artifactid" class="table-of-contents__link">Variant with artifactId</a></li><li><a href="#variant-with-pom" class="table-of-contents__link">Variant with POM</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/jarbird/docs/tutorials/index">Tutorial</a></li><li class="footer__item"><a href="https://github.com/hkhc/jarbird-samples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sample Code</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://hkhc.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">HKHC</a></li><li class="footer__item"><a href="https://github.com/hkhc" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 HKHC. Built with Docusaurus.</div></div></div></footer></div>
<script src="/jarbird/assets/js/runtime~main.9cc06e3f.js"></script>
<script src="/jarbird/assets/js/main.8e29dcb8.js"></script>
</body>
</html>